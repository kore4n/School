<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chungus: whisper.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Chungus
   </div>
   <div id="projectbrief">A voice activated assistant that gives intelligent responses to the user. Also allows for text-based input.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">whisper.cpp </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Expand to see the result</p>
<p><a href="https://github.com/ggerganov/whisper.cpp/actions"><img src="https://github.com/ggerganov/whisper.cpp/workflows/CI/badge.svg" alt="Actions Status" style="pointer-events: none;" class="inline"/></a> <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License: MIT" style="pointer-events: none;" class="inline"/></a> <a href="https://www.npmjs.com/package/whisper.cpp/"><img src="https://img.shields.io/npm/v/whisper.cpp.svg" alt="npm" style="pointer-events: none;" class="inline"/></a></p>
<p>Stable: <a href="https://github.com/ggerganov/whisper.cpp/releases/tag/v1.2.1">v1.2.1</a> / <a href="https://github.com/ggerganov/whisper.cpp/discussions/126">Roadmap | F.A.Q.</a></p>
<p>High-performance inference of <a href="https://github.com/openai/whisper">OpenAI's Whisper</a> automatic speech recognition (ASR) model:</p>
<ul>
<li>Plain C/C++ implementation without dependencies</li>
<li>Apple silicon first-class citizen - optimized via Arm Neon and Accelerate framework</li>
<li>AVX intrinsics support for x86 architectures</li>
<li>VSX intrinsics support for POWER architectures</li>
<li>Mixed F16 / F32 precision</li>
<li>Low memory usage (Flash Attention)</li>
<li>Zero memory allocations at runtime</li>
<li>Runs on the CPU</li>
<li><a href="https://github.com/ggerganov/whisper.cpp/blob/master/whisper.h">C-style API</a></li>
</ul>
<p>Supported platforms:</p>
<ul>
<li>[x] Mac OS (Intel and Arm)</li>
<li>[x] <a href="examples/whisper.objc">iOS</a></li>
<li>[x] <a href="examples/whisper.android">Android</a></li>
<li>[x] Linux / <a href="https://github.com/ggerganov/whisper.cpp/issues/56#issuecomment-1350920264">FreeBSD</a></li>
<li>[x] <a href="examples/whisper.wasm">WebAssembly</a></li>
<li>[x] Windows (<a href="https://github.com/ggerganov/whisper.cpp/blob/master/.github/workflows/build.yml#L117-L144">MSVC</a> and <a href="https://github.com/ggerganov/whisper.cpp/issues/168">MinGW</a>]</li>
<li>[x] <a href="https://github.com/ggerganov/whisper.cpp/discussions/166">Raspberry Pi</a></li>
</ul>
<p>The entire implementation of the model is contained in 2 source files:</p>
<ul>
<li>Tensor operations: <a href="ggml.h">ggml.h</a> / <a href="ggml.c">ggml.c</a></li>
<li>Transformer inference: <a href="whisper.h">whisper.h</a> / <a href="whisper.cpp">whisper.cpp</a></li>
</ul>
<p>Having such a lightweight implementation of the model allows to easily integrate it in different platforms and applications. As an example, here is a video of running the model on an iPhone 13 device - fully offline, on-device: <a href="examples/whisper.objc">whisper.objc</a></p>
<p><a href="https://user-images.githubusercontent.com/1991296/197385372-962a6dea-bca1-4d50-bf96-1d8c27b98c81.mp4">https://user-images.githubusercontent.com/1991296/197385372-962a6dea-bca1-4d50-bf96-1d8c27b98c81.mp4</a></p>
<p>You can also easily make your own offline voice assistant application: <a href="examples/command">command</a></p>
<p><a href="https://user-images.githubusercontent.com/1991296/204038393-2f846eae-c255-4099-a76d-5735c25c49da.mp4">https://user-images.githubusercontent.com/1991296/204038393-2f846eae-c255-4099-a76d-5735c25c49da.mp4</a></p>
<p>Or you can even run it straight in the browser: <a href="examples/talk.wasm">talk.wasm</a></p>
<h1><a class="anchor" id="autotoc_md41"></a>
Implementation details</h1>
<ul>
<li>The core tensor operations are implemented in C (<a href="ggml.h">ggml.h</a> / <a href="ggml.c">ggml.c</a>)</li>
<li>The transformer model and the high-level C-style API are implemented in C++ (<a href="whisper.h">whisper.h</a> / <a href="whisper.cpp">whisper.cpp</a>)</li>
<li>Sample usage is demonstrated in <a href="examples/main">main.cpp</a></li>
<li>Sample real-time audio transcription from the microphone is demonstrated in <a href="examples/stream">stream.cpp</a></li>
<li>Various other examples are available in the [examples](examples) folder</li>
</ul>
<p>The tensor operators are optimized heavily for Apple silicon CPUs. Depending on the computation size, Arm Neon SIMD instrisics or CBLAS Accelerate framework routines are used. The latter are especially effective for bigger sizes since the Accelerate framework utilizes the special-purpose AMX coprocessor available in modern Apple products.</p>
<h1><a class="anchor" id="autotoc_md42"></a>
Quick start</h1>
<p>First, download one of the Whisper models converted in [ggml format](models). For example:</p>
<div class="fragment"><div class="line">bash ./models/download-ggml-model.sh base.en</div>
</div><!-- fragment --><p>Now build the <a href="examples/main">main</a> example and transcribe an audio file like this:</p>
<div class="fragment"><div class="line"># build the main example</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># transcribe an audio file</div>
<div class="line">./main -f samples/jfk.wav</div>
</div><!-- fragment --><hr  />
<p>For a quick demo, simply run <code>make base.en</code>:</p>
<div class="fragment"><div class="line">$ make base.en</div>
<div class="line"> </div>
<div class="line">cc  -I.              -O3 -std=c11   -pthread -DGGML_USE_ACCELERATE   -c ggml.c -o ggml.o</div>
<div class="line">c++ -I. -I./examples -O3 -std=c++11 -pthread -c whisper.cpp -o whisper.o</div>
<div class="line">c++ -I. -I./examples -O3 -std=c++11 -pthread examples/main/main.cpp whisper.o ggml.o -o main  -framework Accelerate</div>
<div class="line">./main -h</div>
<div class="line"> </div>
<div class="line">usage: ./main [options] file0.wav file1.wav ...</div>
<div class="line"> </div>
<div class="line">options:</div>
<div class="line">  -h,        --help              [<span class="keywordflow">default</span>] show <span class="keyword">this</span> help message and exit</div>
<div class="line">  -t N,      --threads N         [4      ] number of threads to use during computation</div>
<div class="line">  -p N,      --processors N      [1      ] number of processors to use during computation</div>
<div class="line">  -ot N,     --offset-t N        [0      ] time offset in milliseconds</div>
<div class="line">  -on N,     --offset-n N        [0      ] segment index offset</div>
<div class="line">  -d  N,     --duration N        [0      ] duration of audio to process in milliseconds</div>
<div class="line">  -mc N,     --max-context N     [-1     ] maximum number of text context tokens to store</div>
<div class="line">  -ml N,     --max-len N         [0      ] maximum segment length in characters</div>
<div class="line">  -bo N,     --best-of N         [5      ] number of best candidates to keep</div>
<div class="line">  -bs N,     --beam-size N       [-1     ] beam size <span class="keywordflow">for</span> beam search</div>
<div class="line">  -wt N,     --word-thold N      [0.01   ] word timestamp probability threshold</div>
<div class="line">  -et N,     --entropy-thold N   [2.40   ] entropy threshold <span class="keywordflow">for</span> decoder fail</div>
<div class="line">  -lpt N,    --logprob-thold N   [-1.00  ] log probability threshold <span class="keywordflow">for</span> decoder fail</div>
<div class="line">  -su,       --speed-up          [false  ] speed up audio by x2 (reduced accuracy)</div>
<div class="line">  -tr,       --translate         [false  ] translate from source language to english</div>
<div class="line">  -di,       --diarize           [false  ] stereo audio diarization</div>
<div class="line">  -nf,       --no-fallback       [false  ] <span class="keywordflow">do</span> not use temperature fallback <span class="keywordflow">while</span> decoding</div>
<div class="line">  -otxt,     --output-txt        [false  ] output result in a text file</div>
<div class="line">  -ovtt,     --output-vtt        [false  ] output result in a vtt file</div>
<div class="line">  -osrt,     --output-srt        [false  ] output result in a srt file</div>
<div class="line">  -owts,     --output-words      [false  ] output script <span class="keywordflow">for</span> generating karaoke video</div>
<div class="line">  -ocsv,     --output-csv        [false  ] output result in a CSV file</div>
<div class="line">  -of FNAME, --output-file FNAME [       ] output file path (without file extension)</div>
<div class="line">  -ps,       --print-special     [false  ] print special tokens</div>
<div class="line">  -pc,       --print-colors      [false  ] print colors</div>
<div class="line">  -pp,       --print-progress    [false  ] print progress</div>
<div class="line">  -nt,       --no-timestamps     [true   ] <span class="keywordflow">do</span> not print timestamps</div>
<div class="line">  -l LANG,   --language LANG     [en     ] spoken language (<span class="stringliteral">&#39;auto&#39;</span> <span class="keywordflow">for</span> <span class="keyword">auto</span>-detect)</div>
<div class="line">             --prompt PROMPT     [       ] initial prompt</div>
<div class="line">  -m FNAME,  --model FNAME       [models/ggml-base.en.bin] model path</div>
<div class="line">  -f FNAME,  --file FNAME        [       ] input WAV file path</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">bash ./models/download-ggml-model.sh base.en</div>
<div class="line">Downloading ggml model base.en ...</div>
<div class="line">ggml-base.en.bin               100%[========================&gt;] 141.11M  6.34MB/s    in 24s</div>
<div class="line">Done! Model <span class="stringliteral">&#39;base.en&#39;</span> saved in <span class="stringliteral">&#39;models/ggml-base.en.bin&#39;</span></div>
<div class="line">You can now use it like <span class="keyword">this</span>:</div>
<div class="line"> </div>
<div class="line">  $ ./main -m models/ggml-base.en.bin -f samples/jfk.wav</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">===============================================</div>
<div class="line">Running base.en on all samples in ./samples ...</div>
<div class="line">===============================================</div>
<div class="line"> </div>
<div class="line">----------------------------------------------</div>
<div class="line">[+] Running base.en on samples/jfk.wav ... (run <span class="stringliteral">&#39;ffplay samples/jfk.wav&#39;</span> to listen)</div>
<div class="line">----------------------------------------------</div>
<div class="line"> </div>
<div class="line">whisper_init_from_file: loading model from <span class="stringliteral">&#39;models/ggml-base.en.bin&#39;</span></div>
<div class="line">whisper_model_load: loading model</div>
<div class="line">whisper_model_load: n_vocab       = 51864</div>
<div class="line">whisper_model_load: n_audio_ctx   = 1500</div>
<div class="line">whisper_model_load: n_audio_state = 512</div>
<div class="line">whisper_model_load: n_audio_head  = 8</div>
<div class="line">whisper_model_load: n_audio_layer = 6</div>
<div class="line">whisper_model_load: n_text_ctx    = 448</div>
<div class="line">whisper_model_load: n_text_state  = 512</div>
<div class="line">whisper_model_load: n_text_head   = 8</div>
<div class="line">whisper_model_load: n_text_layer  = 6</div>
<div class="line">whisper_model_load: n_mels        = 80</div>
<div class="line">whisper_model_load: f16           = 1</div>
<div class="line">whisper_model_load: type          = 2</div>
<div class="line">whisper_model_load: mem required  =  215.00 MB (+    6.00 MB per decoder)</div>
<div class="line">whisper_model_load: kv <span class="keyword">self</span> size  =    5.25 MB</div>
<div class="line">whisper_model_load: kv cross size =   17.58 MB</div>
<div class="line">whisper_model_load: adding 1607 extra tokens</div>
<div class="line">whisper_model_load: model ctx     =  140.60 MB</div>
<div class="line">whisper_model_load: model size    =  140.54 MB</div>
<div class="line"> </div>
<div class="line">system_info: n_threads = 4 / 10 | AVX = 0 | AVX2 = 0 | AVX512 = 0 | FMA = 0 | NEON = 1 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | WASM_SIMD = 0 | BLAS = 1 | SSE3 = 0 | VSX = 0 |</div>
<div class="line"> </div>
<div class="line">main: processing <span class="stringliteral">&#39;samples/jfk.wav&#39;</span> (176000 samples, 11.0 sec), 4 threads, 1 processors, lang = en, task = transcribe, timestamps = 1 ...</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">[00:00:00.000 --&gt; 00:00:11.000]   And so my fellow Americans, ask not what your country can <span class="keywordflow">do</span> <span class="keywordflow">for</span> you, ask what you can <span class="keywordflow">do</span> <span class="keywordflow">for</span> your country.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">whisper_print_timings:     fallbacks =   0 p /   0 h</div>
<div class="line">whisper_print_timings:     load time =   113.81 ms</div>
<div class="line">whisper_print_timings:      mel time =    15.40 ms</div>
<div class="line">whisper_print_timings:   sample time =    11.58 ms /    27 runs (    0.43 ms per run)</div>
<div class="line">whisper_print_timings:   encode time =   266.60 ms /     1 runs (  266.60 ms per run)</div>
<div class="line">whisper_print_timings:   decode time =    66.11 ms /    27 runs (    2.45 ms per run)</div>
<div class="line">whisper_print_timings:    total time =   476.31 ms</div>
</div><!-- fragment --><p>The command downloads the <code>base.en</code> model converted to custom <code>ggml</code> format and runs the inference on all <code>.wav</code> samples in the folder <code>samples</code>.</p>
<p>For detailed usage instructions, run: <code>./main -h</code></p>
<p>Note that the <a href="examples/main">main</a> example currently runs only with 16-bit WAV files, so make sure to convert your input before running the tool. For example, you can use <code>ffmpeg</code> like this:</p>
<div class="fragment"><div class="line">ffmpeg -i input.mp3 -ar 16000 -ac 1 -c:a pcm_s16le output.wav</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md44"></a>
More audio samples</h1>
<p>If you want some extra audio samples to play with, simply run:</p>
<div class="fragment"><div class="line">make samples</div>
</div><!-- fragment --><p>This will download a few more audio files from Wikipedia and convert them to 16-bit WAV format via <code>ffmpeg</code>.</p>
<p>You can download and run the other models as follows:</p>
<div class="fragment"><div class="line">make tiny.en</div>
<div class="line">make tiny</div>
<div class="line">make base.en</div>
<div class="line">make base</div>
<div class="line">make small.en</div>
<div class="line">make small</div>
<div class="line">make medium.en</div>
<div class="line">make medium</div>
<div class="line">make large-v1</div>
<div class="line">make large</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md45"></a>
Memory usage</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Model   </th><th class="markdownTableHeadNone">Disk   </th><th class="markdownTableHeadNone">Mem   </th><th class="markdownTableHeadNone">SHA    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">tiny   </td><td class="markdownTableBodyNone">75 MB   </td><td class="markdownTableBodyNone">~125 MB   </td><td class="markdownTableBodyNone"><code>bd577a113a864445d4c299885e0cb97d4ba92b5f</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">base   </td><td class="markdownTableBodyNone">142 MB   </td><td class="markdownTableBodyNone">~210 MB   </td><td class="markdownTableBodyNone"><code>465707469ff3a37a2b9b8d8f89f2f99de7299dac</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">small   </td><td class="markdownTableBodyNone">466 MB   </td><td class="markdownTableBodyNone">~600 MB   </td><td class="markdownTableBodyNone"><code>55356645c2b361a969dfd0ef2c5a50d530afd8d5</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">medium   </td><td class="markdownTableBodyNone">1.5 GB   </td><td class="markdownTableBodyNone">~1.7 GB   </td><td class="markdownTableBodyNone"><code>fd9727b6e1217c2f614f9b698455c4ffd82463b4</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">large   </td><td class="markdownTableBodyNone">2.9 GB   </td><td class="markdownTableBodyNone">~3.3 GB   </td><td class="markdownTableBodyNone"><code>0f4c8e34f21cf1a914c59d8b3ce882345ad349d6</code>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md46"></a>
Limitations</h1>
<ul>
<li>Inference only</li>
<li>No GPU support (yet)</li>
</ul>
<h1><a class="anchor" id="autotoc_md47"></a>
Another example</h1>
<p>Here is another example of transcribing a <a href="https://upload.wikimedia.org/wikipedia/commons/1/1f/George_W_Bush_Columbia_FINAL.ogg">3:24 min speech</a> in about half a minute on a MacBook M1 Pro, using <code>medium.en</code> model:</p>
<p>&lt;details&gt;</p>
<div class="fragment"><div class="line">$ ./main -m models/ggml-medium.en.bin -f samples/gb1.wav -t 8</div>
<div class="line"> </div>
<div class="line">whisper_init_from_file: loading model from <span class="stringliteral">&#39;models/ggml-medium.en.bin&#39;</span></div>
<div class="line">whisper_model_load: loading model</div>
<div class="line">whisper_model_load: n_vocab       = 51864</div>
<div class="line">whisper_model_load: n_audio_ctx   = 1500</div>
<div class="line">whisper_model_load: n_audio_state = 1024</div>
<div class="line">whisper_model_load: n_audio_head  = 16</div>
<div class="line">whisper_model_load: n_audio_layer = 24</div>
<div class="line">whisper_model_load: n_text_ctx    = 448</div>
<div class="line">whisper_model_load: n_text_state  = 1024</div>
<div class="line">whisper_model_load: n_text_head   = 16</div>
<div class="line">whisper_model_load: n_text_layer  = 24</div>
<div class="line">whisper_model_load: n_mels        = 80</div>
<div class="line">whisper_model_load: f16           = 1</div>
<div class="line">whisper_model_load: type          = 4</div>
<div class="line">whisper_model_load: mem required  = 1720.00 MB (+   43.00 MB per decoder)</div>
<div class="line">whisper_model_load: kv <span class="keyword">self</span> size  =   42.00 MB</div>
<div class="line">whisper_model_load: kv cross size =  140.62 MB</div>
<div class="line">whisper_model_load: adding 1607 extra tokens</div>
<div class="line">whisper_model_load: model ctx     = 1462.35 MB</div>
<div class="line">whisper_model_load: model size    = 1462.12 MB</div>
<div class="line"> </div>
<div class="line">system_info: n_threads = 8 / 10 | AVX = 0 | AVX2 = 0 | AVX512 = 0 | FMA = 0 | NEON = 1 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | WASM_SIMD = 0 | BLAS = 1 | SSE3 = 0 | VSX = 0 |</div>
<div class="line"> </div>
<div class="line">main: processing <span class="stringliteral">&#39;samples/gb1.wav&#39;</span> (3179750 samples, 198.7 sec), 8 threads, 1 processors, lang = en, task = transcribe, timestamps = 1 ...</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">[00:00:00.000 --&gt; 00:00:08.000]   My fellow Americans, <span class="keyword">this</span> day has brought terrible news and great sadness to our country.</div>
<div class="line">[00:00:08.000 --&gt; 00:00:17.000]   At nine o<span class="stringliteral">&#39;clock this morning, Mission Control in Houston lost contact with our Space Shuttle Columbia.</span></div>
<div class="line"><span class="stringliteral">[00:00:17.000 --&gt; 00:00:23.000]   A short time later, debris was seen falling from the skies above Texas.</span></div>
<div class="line"><span class="stringliteral">[00:00:23.000 --&gt; 00:00:29.000]   The Columbia&#39;</span>s lost. There are no survivors.</div>
<div class="line">[00:00:29.000 --&gt; 00:00:32.000]   On board was a crew of seven.</div>
<div class="line">[00:00:32.000 --&gt; 00:00:39.000]   Colonel Rick Husband, Lieutenant Colonel Michael Anderson, Commander Laurel Clark,</div>
<div class="line">[00:00:39.000 --&gt; 00:00:48.000]   Captain David Brown, Commander William McCool, Dr. Kultna Shavla, and Ilan Ramon,</div>
<div class="line">[00:00:48.000 --&gt; 00:00:52.000]   a colonel in the Israeli Air Force.</div>
<div class="line">[00:00:52.000 --&gt; 00:00:58.000]   These men and women assumed great risk in the service to all humanity.</div>
<div class="line">[00:00:58.000 --&gt; 00:01:03.000]   In an age when space flight has come to seem almost routine,</div>
<div class="line">[00:01:03.000 --&gt; 00:01:07.000]   it is easy to overlook the dangers of travel by rocket</div>
<div class="line">[00:01:07.000 --&gt; 00:01:12.000]   and the difficulties of navigating the fierce outer atmosphere of the Earth.</div>
<div class="line">[00:01:12.000 --&gt; 00:01:18.000]   These astronauts knew the dangers, and they faced them willingly,</div>
<div class="line">[00:01:18.000 --&gt; 00:01:23.000]   knowing they had a high and noble purpose in life.</div>
<div class="line">[00:01:23.000 --&gt; 00:01:31.000]   Because of their courage and daring and idealism, we will miss them all the more.</div>
<div class="line">[00:01:31.000 --&gt; 00:01:36.000]   All Americans today are thinking as well of the families of these men and women</div>
<div class="line">[00:01:36.000 --&gt; 00:01:40.000]   who have been given <span class="keyword">this</span> sudden shock and grief.</div>
<div class="line">[00:01:40.000 --&gt; 00:01:45.000]   You<span class="stringliteral">&#39;re not alone. Our entire nation grieves with you,</span></div>
<div class="line"><span class="stringliteral">[00:01:45.000 --&gt; 00:01:52.000]   and those you love will always have the respect and gratitude of this country.</span></div>
<div class="line"><span class="stringliteral">[00:01:52.000 --&gt; 00:01:56.000]   The cause in which they died will continue.</span></div>
<div class="line"><span class="stringliteral">[00:01:56.000 --&gt; 00:02:04.000]   Mankind is led into the darkness beyond our world by the inspiration of discovery</span></div>
<div class="line"><span class="stringliteral">[00:02:04.000 --&gt; 00:02:11.000]   and the longing to understand. Our journey into space will go on.</span></div>
<div class="line"><span class="stringliteral">[00:02:11.000 --&gt; 00:02:16.000]   In the skies today, we saw destruction and tragedy.</span></div>
<div class="line"><span class="stringliteral">[00:02:16.000 --&gt; 00:02:22.000]   Yet farther than we can see, there is comfort and hope.</span></div>
<div class="line"><span class="stringliteral">[00:02:22.000 --&gt; 00:02:29.000]   In the words of the prophet Isaiah, &quot;Lift your eyes and look to the heavens</span></div>
<div class="line"><span class="stringliteral">[00:02:29.000 --&gt; 00:02:35.000]   who created all these. He who brings out the starry hosts one by one</span></div>
<div class="line"><span class="stringliteral">[00:02:35.000 --&gt; 00:02:39.000]   and calls them each by name.&quot;</span></div>
<div class="line"><span class="stringliteral">[00:02:39.000 --&gt; 00:02:46.000]   Because of His great power and mighty strength, not one of them is missing.</span></div>
<div class="line"><span class="stringliteral">[00:02:46.000 --&gt; 00:02:55.000]   The same Creator who names the stars also knows the names of the seven souls we mourn today.</span></div>
<div class="line"><span class="stringliteral">[00:02:55.000 --&gt; 00:03:01.000]   The crew of the shuttle Columbia did not return safely to earth,</span></div>
<div class="line"><span class="stringliteral">[00:03:01.000 --&gt; 00:03:05.000]   yet we can pray that all are safely home.</span></div>
<div class="line"><span class="stringliteral">[00:03:05.000 --&gt; 00:03:13.000]   May God bless the grieving families, and may God continue to bless America.</span></div>
<div class="line"><span class="stringliteral">[00:03:13.000 --&gt; 00:03:19.000]   [Silence]</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">whisper_print_timings:     fallbacks =   1 p /   0 h</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:     load time =   569.03 ms</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:      mel time =   146.85 ms</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:   sample time =   238.66 ms /   553 runs (    0.43 ms per run)</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:   encode time = 18665.10 ms /     9 runs ( 2073.90 ms per run)</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:   decode time = 13090.93 ms /   549 runs (   23.85 ms per run)</span></div>
<div class="line"><span class="stringliteral">whisper_print_timings:    total time = 32733.52 ms</span></div>
</div><!-- fragment --><p> &lt;/details&gt;</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Real-time audio input example</h1>
<p>This is a naive example of performing real-time inference on audio from your microphone. The <a href="examples/stream">stream</a> tool samples the audio every half a second and runs the transcription continously. More info is available in <a href="https://github.com/ggerganov/whisper.cpp/issues/10">issue #10</a>.</p>
<div class="fragment"><div class="line">make stream</div>
<div class="line">./stream -m ./models/ggml-base.en.bin -t 8 --step 500 --length 5000</div>
</div><!-- fragment --><p><a href="https://user-images.githubusercontent.com/1991296/194935793-76afede7-cfa8-48d8-a80f-28ba83be7d09.mp4">https://user-images.githubusercontent.com/1991296/194935793-76afede7-cfa8-48d8-a80f-28ba83be7d09.mp4</a></p>
<h1><a class="anchor" id="autotoc_md49"></a>
Confidence color-coding</h1>
<p>Adding the <code>--print-colors</code> argument will print the transcribed text using an experimental color coding strategy to highlight words with high or low confidence:</p>
<p><img src="https://user-images.githubusercontent.com/1991296/197356445-311c8643-9397-4e5e-b46e-0b4b4daa2530.png" alt="image" width="965" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md50"></a>
Controlling the length of the generated text segments (experimental)</h1>
<p>For example, to limit the line length to a maximum of 16 characters, simply add <code>-ml 16</code>:</p>
<div class="fragment"><div class="line">./main -m ./models/ggml-base.en.bin -f ./samples/jfk.wav -ml 16</div>
<div class="line"> </div>
<div class="line">whisper_model_load: loading model from <span class="stringliteral">&#39;./models/ggml-base.en.bin&#39;</span></div>
<div class="line">...</div>
<div class="line">system_info: n_threads = 4 / 10 | AVX2 = 0 | AVX512 = 0 | NEON = 1 | FP16_VA = 1 | WASM_SIMD = 0 | BLAS = 1 |</div>
<div class="line"> </div>
<div class="line">main: processing <span class="stringliteral">&#39;./samples/jfk.wav&#39;</span> (176000 samples, 11.0 sec), 4 threads, 1 processors, lang = en, task = transcribe, timestamps = 1 ...</div>
<div class="line"> </div>
<div class="line">[00:00:00.000 --&gt; 00:00:00.850]   And so my</div>
<div class="line">[00:00:00.850 --&gt; 00:00:01.590]   fellow</div>
<div class="line">[00:00:01.590 --&gt; 00:00:04.140]   Americans, ask</div>
<div class="line">[00:00:04.140 --&gt; 00:00:05.660]   not what your</div>
<div class="line">[00:00:05.660 --&gt; 00:00:06.840]   country can <span class="keywordflow">do</span></div>
<div class="line">[00:00:06.840 --&gt; 00:00:08.430]   <span class="keywordflow">for</span> you, ask</div>
<div class="line">[00:00:08.430 --&gt; 00:00:09.440]   what you can <span class="keywordflow">do</span></div>
<div class="line">[00:00:09.440 --&gt; 00:00:10.020]   <span class="keywordflow">for</span> your</div>
<div class="line">[00:00:10.020 --&gt; 00:00:11.000]   country.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md51"></a>
Word-level timestamp</h1>
<p>The <code>--max-len</code> argument can be used to obtain word-level timestamps. Simply use <code>-ml 1</code>:</p>
<div class="fragment"><div class="line">./main -m ./models/ggml-base.en.bin -f ./samples/jfk.wav -ml 1</div>
<div class="line"> </div>
<div class="line">whisper_model_load: loading model from <span class="stringliteral">&#39;./models/ggml-base.en.bin&#39;</span></div>
<div class="line">...</div>
<div class="line">system_info: n_threads = 4 / 10 | AVX2 = 0 | AVX512 = 0 | NEON = 1 | FP16_VA = 1 | WASM_SIMD = 0 | BLAS = 1 |</div>
<div class="line"> </div>
<div class="line">main: processing <span class="stringliteral">&#39;./samples/jfk.wav&#39;</span> (176000 samples, 11.0 sec), 4 threads, 1 processors, lang = en, task = transcribe, timestamps = 1 ...</div>
<div class="line"> </div>
<div class="line">[00:00:00.000 --&gt; 00:00:00.320]  </div>
<div class="line">[00:00:00.320 --&gt; 00:00:00.370]   And</div>
<div class="line">[00:00:00.370 --&gt; 00:00:00.690]   so</div>
<div class="line">[00:00:00.690 --&gt; 00:00:00.850]   my</div>
<div class="line">[00:00:00.850 --&gt; 00:00:01.590]   fellow</div>
<div class="line">[00:00:01.590 --&gt; 00:00:02.850]   Americans</div>
<div class="line">[00:00:02.850 --&gt; 00:00:03.300]  ,</div>
<div class="line">[00:00:03.300 --&gt; 00:00:04.140]   ask</div>
<div class="line">[00:00:04.140 --&gt; 00:00:04.990]   not</div>
<div class="line">[00:00:04.990 --&gt; 00:00:05.410]   what</div>
<div class="line">[00:00:05.410 --&gt; 00:00:05.660]   your</div>
<div class="line">[00:00:05.660 --&gt; 00:00:06.260]   country</div>
<div class="line">[00:00:06.260 --&gt; 00:00:06.600]   can</div>
<div class="line">[00:00:06.600 --&gt; 00:00:06.840]   <span class="keywordflow">do</span></div>
<div class="line">[00:00:06.840 --&gt; 00:00:07.010]   <span class="keywordflow">for</span></div>
<div class="line">[00:00:07.010 --&gt; 00:00:08.170]   you</div>
<div class="line">[00:00:08.170 --&gt; 00:00:08.190]  ,</div>
<div class="line">[00:00:08.190 --&gt; 00:00:08.430]   ask</div>
<div class="line">[00:00:08.430 --&gt; 00:00:08.910]   what</div>
<div class="line">[00:00:08.910 --&gt; 00:00:09.040]   you</div>
<div class="line">[00:00:09.040 --&gt; 00:00:09.320]   can</div>
<div class="line">[00:00:09.320 --&gt; 00:00:09.440]   <span class="keywordflow">do</span></div>
<div class="line">[00:00:09.440 --&gt; 00:00:09.760]   <span class="keywordflow">for</span></div>
<div class="line">[00:00:09.760 --&gt; 00:00:10.020]   your</div>
<div class="line">[00:00:10.020 --&gt; 00:00:10.510]   country</div>
<div class="line">[00:00:10.510 --&gt; 00:00:11.000]  .</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md52"></a>
Karaoke-style movie generation (experimental)</h1>
<p>The <a href="examples/main">main</a> example provides support for output of karaoke-style movies, where the currently pronounced word is highlighted. Use the <code>-wts</code> argument and run the generated bash script. This requires to have <code>ffmpeg</code> installed.</p>
<p>Here are a few *"typical"* examples:</p>
<div class="fragment"><div class="line">./main -m ./models/ggml-base.en.bin -f ./samples/jfk.wav -owts</div>
<div class="line">source ./samples/jfk.wav.wts</div>
<div class="line">ffplay ./samples/jfk.wav.mp4</div>
</div><!-- fragment --><p><a href="https://user-images.githubusercontent.com/1991296/199337465-dbee4b5e-9aeb-48a3-b1c6-323ac4db5b2c.mp4">https://user-images.githubusercontent.com/1991296/199337465-dbee4b5e-9aeb-48a3-b1c6-323ac4db5b2c.mp4</a></p>
<hr  />
<div class="fragment"><div class="line">./main -m ./models/ggml-base.en.bin -f ./samples/mm0.wav -owts</div>
<div class="line">source ./samples/mm0.wav.wts</div>
<div class="line">ffplay ./samples/mm0.wav.mp4</div>
</div><!-- fragment --><p><a href="https://user-images.githubusercontent.com/1991296/199337504-cc8fd233-0cb7-4920-95f9-4227de3570aa.mp4">https://user-images.githubusercontent.com/1991296/199337504-cc8fd233-0cb7-4920-95f9-4227de3570aa.mp4</a></p>
<hr  />
<div class="fragment"><div class="line">./main -m ./models/ggml-base.en.bin -f ./samples/gb0.wav -owts</div>
<div class="line">source ./samples/gb0.wav.wts</div>
<div class="line">ffplay ./samples/gb0.wav.mp4</div>
</div><!-- fragment --><p><a href="https://user-images.githubusercontent.com/1991296/199337538-b7b0c7a3-2753-4a88-a0cd-f28a317987ba.mp4">https://user-images.githubusercontent.com/1991296/199337538-b7b0c7a3-2753-4a88-a0cd-f28a317987ba.mp4</a></p>
<hr  />
<h1><a class="anchor" id="autotoc_md56"></a>
Benchmarks</h1>
<p>In order to have an objective comparison of the performance of the inference across different system configurations, use the <a href="examples/bench">bench</a> tool. The tool simply runs the Encoder part of the model and prints how much time it took to execute it. The results are summarized in the following Github issue:</p>
<p><a href="https://github.com/ggerganov/whisper.cpp/issues/89">Benchmark results</a></p>
<h1><a class="anchor" id="autotoc_md57"></a>
ggml format</h1>
<p>The original models are converted to a custom binary format. This allows to pack everything needed into a single file:</p>
<ul>
<li>model parameters</li>
<li>mel filters</li>
<li>vocabulary</li>
<li>weights</li>
</ul>
<p>You can download the converted models using the <a href="models/download-ggml-model.sh">models/download-ggml-model.sh</a> script or manually from here:</p>
<ul>
<li><a href="https://huggingface.co/datasets/ggerganov/whisper.cpp">https://huggingface.co/datasets/ggerganov/whisper.cpp</a></li>
<li><a href="https://ggml.ggerganov.com">https://ggml.ggerganov.com</a></li>
</ul>
<p>For more details, see the conversion script <a href="models/convert-pt-to-ggml.py">models/convert-pt-to-ggml.py</a> or the README in [models](models).</p>
<h1><a class="anchor" id="autotoc_md58"></a>
&lt;a href="https://github.com/ggerganov/whisper.cpp/discussions/categories/bindings"&gt;Bindings&lt;/a&gt;</h1>
<ul>
<li>[X] Rust: <a href="https://github.com/tazz4843/whisper-rs">tazz4843/whisper-rs</a> | <a href="https://github.com/ggerganov/whisper.cpp/discussions/310">#310</a></li>
<li>[X] Javascript: <a href="bindings/javascript">bindings/javascript</a> | <a href="https://github.com/ggerganov/whisper.cpp/discussions/309">#309</a></li>
<li>[X] Go: <a href="bindings/go">bindings/go</a> | <a href="https://github.com/ggerganov/whisper.cpp/discussions/312">#312</a></li>
<li>[X] Ruby: <a href="bindings/ruby">bindings/ruby</a> | <a href="https://github.com/ggerganov/whisper.cpp/discussions/507">#507</a></li>
<li>[X] Objective-C / Swift: <a href="https://github.com/ggerganov/whisper.spm">ggerganov/whisper.spm</a> | <a href="https://github.com/ggerganov/whisper.cpp/discussions/313">#313</a></li>
<li>[X] .NET: | <a href="https://github.com/ggerganov/whisper.cpp/discussions/422">#422</a><ul>
<li><a href="https://github.com/sandrohanea/whisper.net">sandrohanea/whisper.net</a></li>
<li><a href="https://github.com/NickDarvey/whisper">NickDarvey/whisper</a></li>
</ul>
</li>
<li>[X] Python: | <a href="https://github.com/ggerganov/whisper.cpp/issues/9">#9</a><ul>
<li><a href="https://github.com/stlukey/whispercpp.py">stlukey/whispercpp.py</a> (Cython)</li>
<li><a href="https://github.com/aarnphm/whispercpp">aarnphm/whispercpp</a> (Pybind11)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md59"></a>
Examples</h1>
<p>There are various examples of using the library for different projects in the [examples](examples) folder. Some of the examples are even ported to run in the browser using WebAssembly. Check them out!</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Example   </th><th class="markdownTableHeadNone">Web   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/main">main</a>   </td><td class="markdownTableBodyNone"><a href="examples/whisper.wasm">whisper.wasm</a>   </td><td class="markdownTableBodyNone">Tool for translating and transcribing audio using Whisper    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/bench">bench</a>   </td><td class="markdownTableBodyNone"><a href="examples/bench.wasm">bench.wasm</a>   </td><td class="markdownTableBodyNone">Benchmark the performance of Whisper on your machine    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/stream">stream</a>   </td><td class="markdownTableBodyNone"><a href="examples/stream.wasm">stream.wasm</a>   </td><td class="markdownTableBodyNone">Real-time transcription of raw microphone capture    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/command">command</a>   </td><td class="markdownTableBodyNone"><a href="examples/command.wasm">command.wasm</a>   </td><td class="markdownTableBodyNone">Basic voice assistant example for receiving voice commands from the mic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/talk">talk</a>   </td><td class="markdownTableBodyNone"><a href="examples/talk.wasm">talk.wasm</a>   </td><td class="markdownTableBodyNone">Talk with a GPT-2 bot    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/whisper.objc">whisper.objc</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">iOS mobile application using whisper.cpp    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/whisper.swiftui">whisper.swiftui</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">SwiftUI iOS / macOS application using whisper.cpp    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/whisper.android">whisper.android</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Android mobile application using whisper.cpp    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/whisper.nvim">whisper.nvim</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Speech-to-text plugin for Neovim    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/generate-karaoke.sh">generate-karaoke.sh</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Helper script to easily <a href="https://youtu.be/uj7hVta4blM">generate a karaoke video</a> of raw audio capture    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="examples/livestream.sh">livestream.sh</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a href="https://github.com/ggerganov/whisper.cpp/issues/185">Livestream audio transcription</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="examples/yt-wsp.sh">yt-wsp.sh</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Download + transcribe and/or translate any VOD <a href="https://gist.github.com/DaniruKun/96f763ec1a037cc92fe1a059b643b818">(original)</a>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md60"></a>
&lt;a href="https://github.com/ggerganov/whisper.cpp/discussions"&gt;Discussions&lt;/a&gt;</h1>
<p>If you have any kind of feedback about this project feel free to use the Discussions section and open a new topic. You can use the <a href="https://github.com/ggerganov/whisper.cpp/discussions/categories/show-and-tell">Show and tell</a> category to share your own projects that use <code>whisper.cpp</code>. If you have a question, make sure to check the <a href="https://github.com/ggerganov/whisper.cpp/discussions/126">Frequently asked questions (#126)</a> discussion. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
